@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* ── Fallback values (overridden by ThemeProvider from Zen theme system) ── */
    --background: 0 0% 100%;
    --foreground: 222.2 84% 4.9%;
    --card: 0 0% 100%;
    --card-foreground: 222.2 84% 4.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 222.2 84% 4.9%;
    --primary: 262 83% 58%;
    --primary-foreground: 210 40% 98%;
    --secondary: 210 40% 96.1%;
    --secondary-foreground: 222.2 47.4% 11.2%;
    --muted: 210 40% 96.1%;
    --muted-foreground: 215.4 16.3% 46.9%;
    --accent: 262 40% 96.1%;
    --accent-foreground: 222.2 47.4% 11.2%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;
    --border: 214.3 31.8% 91.4%;
    --input: 214.3 31.8% 91.4%;
    --ring: 262 83% 58%;
    --radius: 0.5rem;
    --accent-hue: 262;

    /* Playground gradients for light mode */
    --playground-from: 226 71% 96%;
    --playground-to: 262 77% 95%;
    --playground-dots: 215 28% 17%;

    /* Panel backgrounds for light mode */
    --panel-bg: 0 0% 98%;
    --panel-border: 214.3 31.8% 85%;
  }

  .dark {
    --background: 222.2 84% 4.9%;
    --foreground: 210 40% 98%;
    --card: 222.2 84% 4.9%;
    --card-foreground: 210 40% 98%;
    --popover: 222.2 84% 4.9%;
    --popover-foreground: 210 40% 98%;
    /* --primary, --accent, --ring set dynamically by ThemeProvider */
    --primary-foreground: 222.2 47.4% 11.2%;
    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;
    --muted: 217.2 32.6% 17.5%;
    --muted-foreground: 215 20.2% 65.1%;
    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 40% 98%;
    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;

    /* Playground gradients for dark mode */
    --playground-from: 222 47% 11%;
    --playground-to: 262 47% 11%;
    --playground-dots: 215 20% 65%;

    /* Panel backgrounds for dark mode */
    --panel-bg: 217.2 32.6% 12%;
    --panel-border: 217.2 32.6% 20%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
}

/* Zen Mode global panel shadow (Canvas panels) */
.zen-panel-shadow {
  box-shadow:
    0 10px 38px -10px rgba(0, 0, 0, 0.35),
    0 10px 20px -15px rgba(0, 0, 0, 0.2);
  border-radius: 12px;
}

/* Zen Mode shared panel header styles (Canvas) */
.zen-panel-header {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 14px;
  background: rgba(255, 255, 255, 0.7);
  backdrop-filter: blur(8px);
  border-bottom: 1px solid rgba(0, 0, 0, 0.08);
  border-top-left-radius: 12px;
  border-top-right-radius: 12px;
}

.zen-panel-header-icon {
  font-size: 16px;
  line-height: 1;
}

.zen-panel-header-title {
  flex: 1;
  font-size: 14px;
  font-weight: 600;
  color: #374151;
}

.zen-panel-header-close {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  border: none;
  background: rgba(0, 0, 0, 0.04);
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  color: #1f2937;
  transition: all 0.15s;
}

.zen-panel-header-close:hover {
  background: rgba(0, 0, 0, 0.1);
  color: #020617;
}

/* Shared kbd style for Zen Mode panels */
.zen-kbd {
  display: inline-block;
  padding: 2px 6px;
  background: rgba(0, 0, 0, 0.08);
  border: 1px solid rgba(0, 0, 0, 0.14);
  border-radius: 4px;
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  font-size: 10px;
  font-weight: 600;
  color: #1f2937;
  text-transform: uppercase;
  white-space: nowrap;
}

/* Context Menu shared styles (Zen Mode panels) */
.zen-context-menu {
  position: fixed;
  z-index: 10000;
  min-width: 200px;
  background: rgba(255, 255, 255, 0.98);
  backdrop-filter: blur(12px);
  border: 1px solid rgba(0, 0, 0, 0.08);
  border-radius: 8px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
  padding: 6px;
  animation: contextMenuSlideIn 0.15s ease-out;
}

@keyframes contextMenuSlideIn {
  from {
    opacity: 0;
    transform: translateY(-4px) scale(0.98);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.zen-context-menu-item {
  display: flex;
  align-items: center;
  gap: 10px;
  width: 100%;
  padding: 8px 12px;
  background: none;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-family: inherit;
  font-size: 13px;
  color: #374151;
  text-align: left;
  transition: background 0.1s;
}

.zen-context-menu-item:hover {
  background: rgba(79, 70, 229, 0.08);
}

.zen-context-menu-item-icon {
  font-size: 14px;
  line-height: 1;
  width: 16px;
  text-align: center;
}

.zen-context-menu-item-danger {
  color: #dc2626;
}

.zen-context-menu-item-danger:hover {
  background: rgba(220, 38, 38, 0.08);
}

.zen-context-menu-separator {
  height: 1px;
  background: rgba(0, 0, 0, 0.06);
  margin: 4px 0;
}

.zen-context-menu-submenu {
  padding-top: 4px;
}

.zen-context-menu-label {
  font-size: 11px;
  font-weight: 600;
  color: #9ca3af;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  padding: 6px 12px 4px;
}

/* Disable instant theme transitions when changing themes */
.no-theme-transition,
.no-theme-transition *,
svg,
svg * {
  transition-property: none !important;
}

/* Session highlight animation (focus/locate from chat panel) */
.session-highlight {
  animation: pulse-highlight 2s ease-out;
  z-index: 9999 !important;
}

@keyframes pulse-highlight {
  0% {
    box-shadow: 0 0 0 4px rgba(255, 165, 0, 0.8);
  }
  100% {
    box-shadow: 0 0 0 0 rgba(255, 165, 0, 0);
  }
}

/* ═══════════════════════════════════════════════════════════════
   Syntax Highlighting (theme-aware, respects CSS variables)
   ═══════════════════════════════════════════════════════════════ */

/* Code blocks */
.hljs {
  display: block;
  overflow-x: auto;
  padding: 1em;
  background: hsl(var(--secondary));
  color: hsl(var(--foreground));
  border-radius: 8px;
}

/* Code syntax colors — set dynamically by ThemeProvider from the active Zen theme.
   Fallback values below match a neutral dark palette. */
:root {
  --code-comment: 215 20% 60%;
  --code-keyword: var(--primary);
  --code-string: 150 60% 60%;
  --code-number: 30 90% 65%;
  --code-function: 200 70% 65%;
  --code-builtin: 280 60% 70%;
}

/* Comments */
.hljs-comment,
.hljs-quote {
  color: hsl(var(--code-comment));
  font-style: italic;
}

/* Keywords, selectors, operators */
.hljs-keyword,
.hljs-selector-tag,
.hljs-type,
.hljs-tag {
  color: hsl(var(--code-keyword));
  font-weight: 600;
}

/* Strings, symbols */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
  color: hsl(var(--code-string));
}

/* Numbers, literals */
.hljs-number,
.hljs-literal,
.hljs-meta .hljs-string {
  color: hsl(var(--code-number));
}

/* Functions, class names */
.hljs-title,
.hljs-class .hljs-title,
.hljs-function .hljs-title {
  color: hsl(var(--code-function));
  font-weight: 600;
}

/* Attributes, properties */
.hljs-attr,
.hljs-attribute,
.hljs-variable,
.hljs-template-variable {
  color: hsl(var(--foreground));
}

/* Built-ins, params */
.hljs-built_in,
.hljs-builtin-name,
.hljs-params {
  color: hsl(var(--code-builtin));
}

/* Meta, doctags */
.hljs-meta,
.hljs-doctag {
  color: hsl(var(--muted-foreground));
}

/* Sections, names */
.hljs-section,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class {
  color: hsl(var(--code-function));
}

/* Emphasis */
.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: 700;
}

/* Deletion */
.hljs-deletion {
  color: hsl(0 70% 60%);
}

/* Formula */
.hljs-formula {
  background: hsl(var(--muted));
  color: hsl(var(--foreground));
}

/* Regexp */
.hljs-regexp,
.hljs-link {
  color: hsl(var(--code-string));
}

/* ─── Prop Movement Cursors ──────────────────────────────────── */
/* Applied to the canvas element for reliable cursor during 3D interactions */
.cursor-grab,
.cursor-grab canvas {
  cursor: grab !important;
}
.cursor-grabbing,
.cursor-grabbing canvas {
  cursor: grabbing !important;
}
.cursor-not-allowed,
.cursor-not-allowed canvas {
  cursor: not-allowed !important;
}

/* ─── Streaming Chat Cursor ─────────────────────────────────── */
@keyframes streaming-cursor-blink {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: 0;
  }
}
